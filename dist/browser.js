var e,t,n,a,r;function c(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}let o,s,i,l;async function u(){if(o)return o;const e=new URLSearchParams(window.location.search).get("channel"),t=await fetch(`https://decapi.me/twitch/id/${e}`);return o=await t.text(),o}e=module.exports,Object.defineProperty(e,"__esModule",{value:!0,configurable:!0}),t=module.exports,n="default",a=()=>b,Object.defineProperty(t,n,{get:a,set:r,enumerable:!0,configurable:!0});var p={getBttvGlobalLookupTable:async function(){if(s)return s;const e=await fetch("https://api.betterttv.net/3/cached/emotes/global"),t=await e.json();return s=t.reduce(((e,t)=>{const n={id:t.id,type:t.imageType};return e[t.code]=n,e}),{}),s},getBttvChannelLookupTable:async function(){if(i)return i;const e=await u(),t=await fetch(`https://api.betterttv.net/3/cached/users/twitch/${e}`),n=await t.json(),a=n.channelEmotes.concat(n.sharedEmotes);return i=a.reduce(((e,t)=>{const n={id:t.id,type:t.imageType};return e[t.code]=n,e}),{}),i},getFfzChannelLookupTable:async function(){if(l)return l;const e=await u(),t=await fetch(`https://api.betterttv.net/3/cached/frankerfacez/users/twitch/${e}`),n=await t.json();return l=n.reduce(((e,t)=>{const n={id:t.id,type:t.imageType};return e[t.code]=n,e}),{}),l}};var d=async(e,t)=>{let n=e;return n=((e,t)=>{if(!t)return e;let n=e;const a={};for(const[n,r]of Object.entries(t)){const[t,c]=r[0].split("-");a[e.slice(Number(t),Number(c)+1)]=`<img src="https://static-cdn.jtvnw.net/emoticons/v2/${n}/default/light/2.0" alt="emote" />`}for(const[e,t]of Object.entries(a)){const a=new RegExp(`(?:^|(?<=\\s))${c(e)}(?:(?=\\s)|$)`,"g");n=n.replaceAll(a,t)}return n})(n,t),n=await(async e=>{const t=await p.getBttvGlobalLookupTable(),n=Object.keys(t);if(n.every((t=>!e.includes(t))))return e;let a=e;return n.forEach((e=>{const n=c(e),r=new RegExp(`\\b${n}\\b`,"g");a=a.replaceAll(r,(e=>`<img src="https://cdn.betterttv.net/emote/${t[e].id}/2x" />`))})),a})(n),n=await(async e=>{const t=await p.getBttvChannelLookupTable(),n=Object.keys(t);if(n.every((t=>!e.includes(t))))return e;let a=e;return n.forEach((e=>{const n=c(e),r=new RegExp(`\\b${n}\\b`,"g");a=a.replaceAll(r,(e=>`<img src="https://cdn.betterttv.net/emote/${t[e].id}/2x" />`))})),a})(n),n=await(async e=>{const t=await p.getFfzChannelLookupTable(),n=Object.keys(t);if(n.every((t=>!e.includes(t))))return e;let a=e;return n.forEach((e=>{const n=c(e),r=new RegExp(`\\b${n}\\b`,"g");a=a.replaceAll(r,(e=>`<img src="https://cdn.betterttv.net/frankerfacez_emote/${t[e].id}/2" />`))})),a})(n),n};let f,h={};const w=async e=>{f||await(async()=>{if(f)return f;const e=await fetch("https://pronouns.alejo.io/api/pronouns");return f=await e.json(),f=f.reduce(((e,t)=>(e[t.name]=t.display,e)),{}),f})();const t=await fetch(`https://pronouns.alejo.io/api/users/${e}`),n=(await t.json())?.[0]?.pronoun_id;return n&&(h[e]=f[n]),h[e]};var b=async(e,t)=>({messageHTML:await d(t,e.emotes),pronounsText:await w(e.username),displayName:e["display-name"],userColor:e.color});
//# sourceMappingURL=browser.js.map
